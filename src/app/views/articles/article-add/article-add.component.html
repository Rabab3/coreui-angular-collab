<div class="container mt-4 form">
  <h2 class="mb-4">Ajouter un article</h2>
  <form [formGroup]="articleForm" (ngSubmit)="onSubmit()" novalidate>

    <div class="mb-3">
      <label for="titre" class="form-label">Titre</label>
      <input type="text" id="titre" formControlName="titre" class="form-control" />
      <div *ngIf="submitted && f['titre'].errors" class="text-danger">
        Le titre est requis.
      </div>
    </div>

    <div class="mb-3">
      <label for="description" class="form-label">Description</label>
      <textarea id="description" formControlName="description" class="form-control" rows="4"></textarea>
      <div *ngIf="submitted && f['description'].errors" class="text-danger">
        La description est requise.
      </div>
    </div>

    <div class="mb-3">
      <label for="categorie" class="form-label">Catégorie</label>
      <select id="categorie" formControlName="categorie" class="form-select">
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
      <div *ngIf="submitted && f['categorie'].errors" class="text-danger">
        La catégorie est requise.
      </div>
    </div>

    <div class="mb-3">
      <label for="fichiers" class="form-label">Fichiers</label>
      <input type="file" id="fichiers" (change)="onFileChange($event)" class="form-control" multiple />
    </div>

    <div *ngIf="selectedFiles.length > 0" class="mt-3 file-list">
      <h6 class="fw-semibold">Fichiers sélectionnés (catégorie : {{ articleForm.get('categorie')?.value }}) :</h6>
      <ul>
        <li *ngFor="let file of selectedFiles; let i = index">
          {{ file.name }}
          <button class="remove-btn ms-3" type="button" (click)="removeFile(articleForm.get('categorie')?.value, i)">X</button>
        </li>
      </ul>
    </div>

    <div class="text-center mt-4">
      <button class="btn btn-primary btn-lg" type="submit">Soumettre</button>
    </div>
  </form>
</div>
