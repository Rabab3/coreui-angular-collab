<!-- âœ… article-add.component.html (complet avec brouillon, public, actualisation reset) -->
<div class="container mt-4 add-article-container">
  <h2>Ajouter un article</h2>

  <form [formGroup]="articleForm" (ngSubmit)="onSubmit()" novalidate>
    <!-- Titre -->
    <div class="mb-3">
      <label for="titre">Titre</label>
      <input type="text" id="titre" class="form-control" formControlName="titre" />
      <div *ngIf="submitted && f['titre'].errors" class="text-danger">Le titre est requis.</div>
    </div>

    <!-- Mode de saisie -->
    <div class="mb-3">
      <label>Mode de saisie</label><br />
      <button type="button" class="btn btn-outline-light me-2" [class.active]="!useTextEditor" (click)="toggleInputMode('file')">ğŸ“ Fichier</button>
      <button type="button" class="btn btn-outline-light" [class.active]="useTextEditor" (click)="toggleInputMode('text')">ğŸ“ Ã‰crire</button>
    </div>

    <!-- Upload fichier -->
    <div class="mb-3" *ngIf="!useTextEditor">
      <label>TÃ©lÃ©verser un fichier</label>
      <input type="file" class="form-control" (change)="onFileChange($event)" multiple />
      <ul class="mt-2" *ngIf="selectedFiles.length > 0">
        <li *ngFor="let file of selectedFiles; let i = index" class="file-item">
          {{ file.name }}
          <button type="button" class="btn btn-sm btn-danger ms-2" (click)="removeFile(i)">âŒ</button>
        </li>
      </ul>
    </div>

    <!-- Ã‰diteur -->
    <div class="mb-3" *ngIf="useTextEditor">
      <label>Contenu  </label>
      <ngx-editor [editor]="editor" formControlName="description" placeholder="RÃ©digez ici..."></ngx-editor>
    </div>

    <!-- CatÃ©gorie -->
    <div class="mb-3">
      <label for="categorie">CatÃ©gorie</label>
      <select class="form-select" formControlName="categorie">
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
    </div>

    <!-- Tags -->
    <div class="mb-3">
      <label for="tags">Tags (hashtags)</label>
      <input type="text" class="form-control" formControlName="tags" placeholder="#angular #sÃ©curitÃ© ..." />
    </div>

    <!-- Source -->
    <div class="mb-3">
      <label for="source">Source (facultatif)</label>
      <input type="text" class="form-control" formControlName="source" placeholder="https://..." />
    </div>

    <!-- VisibilitÃ© -->
    <div class="mb-3">
      <label for="visibilite">VisibilitÃ©</label>
      <select class="form-select" formControlName="visibilite">
        <option value="public">ğŸŒ Public</option>
        <option value="brouillon">ğŸ“‹ Brouillon</option>
      </select>
    </div>

    <!-- Actions -->
    <div class="text-center mt-4">
      <button type="button" class="btn btn-outline-primary me-2" (click)="openPreview()">ğŸ‘ï¸ AperÃ§u</button>
      <button type="button" class="btn btn-secondary me-2" (click)="exportAsPDF()">ğŸ“„ Export PDF</button>
      <button type="button" class="btn btn-secondary me-2" (click)="exportAsWord()">ğŸ“ Export Word</button>
      <button type="submit" class="btn btn-success px-4">âœ… Soumettre</button>
    </div>
  </form>

  <!-- MODALE APERÃ‡U -->
  <div *ngIf="showPreviewModal" class="preview-modal">
    <div class="preview-box">
      <h4>AperÃ§u de lâ€™article</h4>
      <p><strong>Titre :</strong> {{ articleForm.value.titre }}</p>
      <p><strong>CatÃ©gorie :</strong> {{ articleForm.value.categorie }}</p>
      <p><strong>Tags :</strong> {{ articleForm.value.tags }}</p>
      <p><strong>VisibilitÃ© :</strong> {{ articleForm.value.visibilite }}</p>
      <p><strong>Date :</strong> {{ today }}</p>
      <div class="content-preview" [innerHTML]="useTextEditor ? articleForm.value.description : 'ğŸ“Œ Fichier sÃ©lectionnÃ©'"></div>
      <button class="btn btn-outline-light mt-3" (click)="closePreview()">âŒ Fermer</button>
    </div>
  </div>
</div>
